<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><meta name="keywords" content="[object Object]"><meta name="description" content="⚓️ 前排提示：
本篇第一部分的大部分内容来源：
https://www.bilibili.com/video/BV1EW411u7th?p"><meta name="author" content="exceting"><title>LV4-5：网络通信、协议、序列化、程序之间的联系 - S-Virus</title><meta description="⚓️ 前排提示： 本篇第一部分的大部分内容来源： https:&amp;#x2F;&amp;#x2F;www.bilibili.com&amp;#x2F;video&amp;#x2F;BV1EW411u7th?p&amp;#x3D;28 https:&amp;#x2F;&amp;#x2F;www.bilibili.com&amp;#x2F;video&amp;#x2F;BV1EW411u7th?p&amp;#x3D;29 https:&amp;#x2F;&amp;#x2F;www.bilibili.com&amp;#x2F;video&amp;#x2F;BV1EW411u7th?p&amp;#x3D;30 本篇第一部分仅做计算机网络的简单介绍，旨在帮助你梳理你"><meta property="og:type" content="article"><meta property="og:title" content="LV4-5：网络通信、协议、序列化、程序之间的联系"><meta property="og:url" content="http://yoursite.com/2020/03/27/LV4-5%EF%BC%9A%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E3%80%81%E5%8D%8F%E8%AE%AE%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E3%80%81%E7%A8%8B%E5%BA%8F%E4%B9%8B%E9%97%B4%E7%9A%84%E8%81%94%E7%B3%BB/"><meta property="og:site_name" content="S-Virus"><meta property="og:description" content="⚓️ 前排提示： 本篇第一部分的大部分内容来源： https:&amp;#x2F;&amp;#x2F;www.bilibili.com&amp;#x2F;video&amp;#x2F;BV1EW411u7th?p&amp;#x3D;28 https:&amp;#x2F;&amp;#x2F;www.bilibili.com&amp;#x2F;video&amp;#x2F;BV1EW411u7th?p&amp;#x3D;29 https:&amp;#x2F;&amp;#x2F;www.bilibili.com&amp;#x2F;video&amp;#x2F;BV1EW411u7th?p&amp;#x3D;30 本篇第一部分仅做计算机网络的简单介绍，旨在帮助你梳理你"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://myblog.sharemer.com/avatar_2.png"><meta property="article:published_time" content="2020-03-27T04:34:00.000Z"><meta property="article:modified_time" content="2020-06-21T03:30:20.724Z"><meta property="article:author" content="exceting"><meta property="article:tag" content="网络编程"><meta property="article:tag" content="教程"><meta property="article:tag" content="基础知识"><meta property="article:tag" content="序列化"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="http://myblog.sharemer.com/avatar_2.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2020/03/27/LV4-5%EF%BC%9A%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E3%80%81%E5%8D%8F%E8%AE%AE%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E3%80%81%E7%A8%8B%E5%BA%8F%E4%B9%8B%E9%97%B4%E7%9A%84%E8%81%94%E7%B3%BB/"},"headline":"LV4-5：网络通信、协议、序列化、程序之间的联系","image":["http://myblog.sharemer.com/avatar_2.png"],"datePublished":"2020-03-27T04:34:00.000Z","dateModified":"2020-06-21T03:30:20.724Z","author":{"@type":"Person","name":"exceting"},"description":"⚓️ 前排提示： 本篇第一部分的大部分内容来源： https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1EW411u7th?p&#x3D;28 https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1EW411u7th?p&#x3D;29 https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1EW411u7th?p&#x3D;30 本篇第一部分仅做计算机网络的简单介绍，旨在帮助你梳理你"}</script><link rel="alternative" href="/atom.xml" title="S-Virus" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.12/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/css/style.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="http://myblog.sharemer.com/logooo.png" alt="S-Virus" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/categories/%E6%97%A5%E5%B8%B8/">日常</a><a class="navbar-item" href="/course">教程</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/timeline">时间轴</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/exceting"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2020-03-27  <a class="commentCountImg" href="/2020/03/27/LV4-5%EF%BC%9A%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E3%80%81%E5%8D%8F%E8%AE%AE%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E3%80%81%E7%A8%8B%E5%BA%8F%E4%B9%8B%E9%97%B4%E7%9A%84%E8%81%94%E7%B3%BB/#comment-container"><span class="display-none-class">1f094c9429d8d5f94ea1ed0b1b74169c</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="1f094c9429d8d5f94ea1ed0b1b74169c">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>2 小时  <i class="fas fa-pencil-alt"> </i>18.5k</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">LV4-5：网络通信、协议、序列化、程序之间的联系</h1><div class="content"><blockquote>
<p>⚓️ 前排提示：</p>
<p>本篇<code>第一部分</code>的大部分内容来源：</p>
<p><a href="https://www.bilibili.com/video/BV1EW411u7th?p=28">https://www.bilibili.com/video/BV1EW411u7th?p=28</a></p>
<p><a href="https://www.bilibili.com/video/BV1EW411u7th?p=29">https://www.bilibili.com/video/BV1EW411u7th?p=29</a></p>
<p><a href="https://www.bilibili.com/video/BV1EW411u7th?p=30">https://www.bilibili.com/video/BV1EW411u7th?p=30</a></p>
<p>本篇第一部分仅做<strong>计算机网络的简单介绍，旨在帮助你梳理你写的java业务程序在全局充当一个怎样的地位</strong>，另外一个目的是为了引入<code>tomcat</code>与<code>java web</code>程序，还有<code>http</code>是怎么回事，常说的建连和<code>三次握手四次挥手</code>又是指什么（如果你是计算机科班的话，对这些应该会比较熟悉，如果忘了也不要紧，这里会再重新帮你梳理一下）。看懂第一部分后，你会很容易的理解<code>tomcat</code>是什么，<code>浏览器</code>是什么，然后你甚至可以发散下思维，我们常说的<code>RPC框架</code>又是啥。看懂第一部分后，第二部分的<code>序列化</code>以及为什么要序列化以及<code>json</code>是什么就更加容易理解了，之后利用SDK连接操作<code>mysql</code>、<code>redis</code>等服务端，你也可以很容易理解，看懂第一部分后，你可以尝试自学下java的套接字<code>Socket</code>部分的内容，当然没兴趣也可以不学，因为幸运的是，<code>tomcat</code>等web服务器程序已经帮你规避掉这部分的开发了，你要做的是业务代码的开发</p>
</blockquote>
<a id="more"></a>

<h2 id="一、网络发展史"><a href="#一、网络发展史" class="headerlink" title="一、网络发展史"></a>一、网络发展史</h2><p>你在计算机上请求一个网站的数据，需要发起一个http请求，然后你传输的参数以及path信息漂洋过海跑到该网站的服务器上（request），服务器收到你的请求后，找到对应的程序，解析出来你传的参数和path，这个时候该程序内部对应path的逻辑将被触发，到此为止，你已经成功进入服务端程序的内部了，经过一系列内部逻辑的处理，服务端将处理结果再次通过http协议将数据包发送到你的电脑上（response）。这个过程在网络畅通和对方服务端程序没有瓶颈的条件下，可能在极短的时间内就会完成（以毫秒甚至纳秒计），即便真实的服务器可能离你几百公里。</p>
<p>这个过程里发生了什么呢？</p>
<h3 id="1-1：局域网"><a href="#1-1：局域网" class="headerlink" title="1.1：局域网"></a>1.1：局域网</h3><h4 id="1-1-1：以太网简介"><a href="#1-1-1：以太网简介" class="headerlink" title="1.1.1：以太网简介"></a>1.1.1：以太网简介</h4><p>毫无疑问，用户在全球网络中发送和接收信息的能力，永远改变了这个世界。150年前，发一封信件从伦敦到加州要花2~3周，而且还是特快邮件，如今，电子邮件只要几分之一秒，时延改变了上百万倍，振兴了全球经济，帮助现代世界在遍布全球的光纤中快速发展。你可能觉得计算机和网络密切相关，但事实上，1970年以前，大多数计算机是独立运行的，然而，因为大型计算机开始随处可见，廉价机器开始出现在书桌上，分享数据和资源渐渐变得有用起来，首个计算机网络出现了。</p>
<p>第一个计算机网络出现在1950~1960年代，通常在公司或研究室内部使用，为了方便信息交换，比把纸卡或磁带送到另一栋楼里更快速可靠，这叫“球鞋网络”，第二个好处是能共享物理资源，举个例子，与其每台电脑配一台打印机，大家可以共享一台联网的打印机，早期网络也会共享存储空间，因为每台电脑都配存储器太贵了，计算机近距离构成的小型网络叫做<code>局域网</code>，简称<code>LAN</code>，局域网能小到是同一个房间里的两台机器，或大到校园里的上千台机器，尽管开发和部署了很多不同的LAN技术，其中最著名和成功的是“<code>以太网</code>”（英文名称：<code>Ethernet</code>），开发于1970年代，在施乐的“帕洛阿尔托研究中心”诞生，今天仍被广泛使用。以太网的最简单形式是：一条以太网电线连接数台计算机：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-1.png?imageView2/0/w/600" alt="图1" title="图1"></p>
<h4 id="1-1-2：数据传输"><a href="#1-1-2：数据传输" class="headerlink" title="1.1.2：数据传输"></a>1.1.2：数据传输</h4><p>当一台计算机要传数据给另一台计算机时，它以电信号形式，将数据传入电缆，当然，由于电缆是共享的，连在同一个网络里的其他计算机也能看得到数据：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-2.png?imageView2/0/w/600" alt="图2" title="图2"></p>
<p>如<code>图2</code>由A发出的数据会被BCDEF接到，正因如此，它们不知道A发出的这些数据是给它们中的哪一个的，为了解决这个问题，以太网需要每台计算机有唯一的媒体访问控制地址，简称<code>MAC地址</code>，这个地址放到数据的头部，作为数据的前缀发送到网络中，所以计算机只需要监听以太网电缆，只有匹配到自己的MAC地址才去处理数据，这个过程如下：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-3.png?imageView2/0/w/860" alt="图3" title="图3"></p>
<p>这运作的很好，现在制造的每一台计算机都自带唯一<code>MAC地址</code>用于<code>以太网</code>和<code>无线网络</code>。</p>
<p>多台电脑共享一个传输媒介，这种方法叫做“<code>载波侦听多路访问</code>”，简称“<code>CSMA</code>”，这里的载体指的就是运输数据的共享媒介，以太网的载体是铜线，WIFI的载体是传播无线电波的空气。很多计算机同时侦听载体，所以叫“侦听”和多路访问，而载体传输数据的速度叫“<code>带宽</code>”。</p>
<h4 id="1-1-3：冲突域"><a href="#1-1-3：冲突域" class="headerlink" title="1.1.3：冲突域"></a>1.1.3：冲突域</h4><p>不幸的是，使用共享载体有个很大的弊端，当网络流量较小时，计算机可以等待载体清空，然后传送数据，但随着网络流量的上升，两台计算机想要同时写入数据的概率也会上升，比如A机和F机同时发出一个数据包：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-4.png?imageView2/0/w/600" alt="图4" title="图4"></p>
<p>看，共享载体冲突了。就像两个人打电话，他们同时在电话里讲话一样。幸运的是，计算机能够监听电线中的信号检测这些冲突，最明显的解决办法是停止传输，等待网络空闲，然后再试一次，问题是，其他计算机也打算这样做，其他等待着的计算机可能在任何停顿间隙闯入，导致越来越多冲突，很快每个人都一个接一个的讲话，而且有一堆事要说，就像在家庭聚餐时和男朋友分手一样，这可不是个好主意。以太网有个超简单有效的方法，当计算机检测到冲突，就会在重传之前等待一小段时间，因为要举例，假设是一秒好了，当然，如果所有的计算机都用同样的等待时间是不行的，因为它们会在1s再次冲突，所以这个时间是随机的，这样就保证了每台机器下次重试的时间都不一样，然后大幅度降低冲突概率，这有用，但不能完全解决问题，所以要用另一个小技巧，正如我刚才说的，如果一台计算机在传输数据期间检测到冲突，会等1秒+随机时间，然而如果再次发生冲突，则表明有网络拥塞，这次不再等1s，而是2s，如果再次发生冲突，则等4s、8s、16s以此类推，直到成功传输为止。因为计算机的这种退避策略，冲突次数减少了，数据再次流动，网络再次畅通了，家庭晚餐有救了~这种指数级增长等待时间的方法叫做：<code>指数退避</code>。以太网和WiFi都用这种方法，很多其他传输协议也用。</p>
<p>但即便有了指数退避这种技巧，想用一根网线连通整个大学的计算机是不可能的，为了减少冲突+提升效率，我们需要减少同一载体中设备的数量，载体和设备统称“<code>冲突域</code>”（上面的例子就是一个冲突域，因为6个设备共享一个载体）</p>
<h4 id="1-1-4：利用交换机降低冲突域大小"><a href="#1-1-4：利用交换机降低冲突域大小" class="headerlink" title="1.1.4：利用交换机降低冲突域大小"></a>1.1.4：利用交换机降低冲突域大小</h4><p>仍然以上面的例子为基础，例子中冲突域设备数量为6，我们利用交换机把它拆为两个冲突域，这样，单位冲突域内设备数量就会降低，冲突发生的概率也会大幅下降：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-5.png?imageView2/0/w/600" alt="图5" title="图5"></p>
<p>交换机位于两个更小的网络之间，必要时才在两个网络间传数据，交换机会记录一个MAC地址列表，记录哪个MAC地址位于哪边的网络，所以，我们现在让A发送数据到C，交换机会控制不再让DEF接收到数据：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-6.png?imageView2/0/w/600" alt="图6" title="图6"></p>
<p>如果同时E想要发送数据到F，网络就依然是空的，不会跟A→C这个网络传输冲突。那如果F想要传数据给A呢？这时仍然跟之前是一样的，整个通道都会被占用：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-7.png?imageView2/0/w/600" alt="图7" title="图7"></p>
<p>大型的计算机网络也是这样构建的，包括大的网络：互联网，也是由多个连在一起的稍小的网络组成，使不同网络间信息互相传递。</p>
<p>这些大型网络比较有趣的一点是从一个地点到另一个地点通常有多条线路，这就带出了另一个话题：<code>路由</code>。</p>
<h4 id="1-1-5：路由"><a href="#1-1-5：路由" class="headerlink" title="1.1.5：路由"></a>1.1.5：路由</h4><p>连接两个相隔遥远的计算机或者网络，最简单的办法就是分配一条专用的通信线路，早期电话系统就是这样运作的，比如如果在1910年的北京和上海，北京的小明想要打电话给上海的小红，而北京到上海的电话线只有5条：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-8.png?imageView2/0/w/700" alt="图8" title="图8"></p>
<p>这叫“<code>电路交换</code>”，因为是要把电路连接到正确的目的地，能用是能用，但是不灵活，而且价格昂贵，因为总有闲置线路，好处是，如果有一条专属于自己的线路，你可以最大限度的随意使用，无需共享，因此军队、银行和其他一些机构依然会购买专用线路来连接数据中心。</p>
<p>传输数据的另一种方法是“<code>报文交换</code>”，报文交换就像邮政系统一样，不像之前A和B有一条专有线路，而是信息会经过好几个站点，比如从北京发一封信到上海可能会中转以下线路：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-9.png?imageView2/0/w/400" alt="图9" title="图9"></p>
<p>每一个站点都知道下一个站点将会发往哪里，因为站点有表格，记录到各个目的地，信件该怎么传。报文交换的好处是可以使用不同的路由使信件传输更可靠更能容错，比如让<code>图9</code>中的济南站点断路，那么此时换另外一条传输线路仍然是ok的，虽然不是最优解，但确实解决了现在济南站点无法工作的问题：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-10.png?imageView2/0/w/400" alt="图10" title="图10"></p>
<p>看，转郑州线路也是个不错的选择，至少你的信件最终还是顺利到达了上海。</p>
<p>在上面送邮件这个例子中，每个城市邮局站点就像路由器一样，消息沿着路由跳转的次数叫“<code>跳数</code>”，记录跳数很有用，因为可以分辨出路由问题。</p>
<p>现在假设北京传输信息到上海，假设转至郑州，郑州认为去往上海的最快线路应该是中转济南这条，但是济南认为去往上海的最佳路线应该是郑州，这就糟糕了，因为两个城市看到的目的地都是上海，它们互相认为对方是“最优解”，然后这个信息在济南和郑州之间转来转去：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-11.png?imageView2/0/w/600" alt="图11" title="图11"></p>
<p>图中的问题不仅浪费带宽，而且这种路由错误需要被修复。这种错误会被检测到，因为跳数被记录在消息中，传输时会更新跳数，如果看到某条消息的跳数很高，就可以知道路由肯定哪里出错了，这叫做“<code>跳数限制</code>”。</p>
<p>报文交换的缺点之一是有时报文比较大，会堵塞网络，因为要把整个报文从一站转到下一站后，才能继续传递其他报文，传输一个大文件时，整条路都堵塞了，这时即便你有一个只有1kb的电子邮件要传输，也只能等大文件传完，或是选另一条效率稍低的线路，这就糟了，解决方法是将大报文分成很多小块，这些小数据块就是“<code>数据包</code>”，就像报文交换，每个数据包都有目标地址，因此路由器知道下一站该发往哪里，报文具体格式由“<code>互联网协议</code>”定义，简称<code>IP</code>，这个标准创建于1970年代，每台联网的计算机都需要有一个自己的IP地址，你可能见过，以点分割的4组数字，例120.92.174.135就是哔哩哔哩一个服务器的IP地址。</p>
<p>数百万计算机在网络上不断交换数据，瓶颈的出现和消失是毫秒级的，路由器会<code>平衡</code>和其他路由器之间的负载，以确保传输可以快速可靠，这叫做“<code>阻塞控制</code>”，有时同一个报文的不同数据包会经过不同的线路：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-12.png?imageView2/0/w/700" alt="图12" title="图12"></p>
<p>最终上海收到了全部由北京发出的数据，但是四个数据包传过来时经历的路由路径可能不一样（图中线路颜色对应具体数据包颜色）。</p>
<p>但是拆包意味着有另外一个问题：到达顺序问题。这对于一些软件来说这是个大问题，比如<code>图12</code>里最终到达顺序变成了下面这样：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-13.png?imageView2/0/w/700" alt="图13" title="图13"></p>
<p>这该怎么办呢？幸运的是，在IP协议之上还有其他的协议，例如<code>TCP/IP</code>，就可以解决乱序问题（TCP/IP下节会说）。</p>
<p>将数据拆分成多个小数据包，然后通过灵活的路由传递，非常高效且可容错，如今互联网就是这么运行的，这叫做”<code>分组交换</code>“，有个好处是，它是<code>去中心化</code>的，没有中心权威机构，没有单点失败问题，事实上，在冷战时期有核攻击威胁，所以创造了分组交换，如今，全球的路由器协同工作，找出高效的线路，用各种标准协议运输数据，比如”<code>因特网控制消息协议</code>“（<code>ICMP</code>）和”<code>边界网关协议</code>“（<code>BGP</code>），世界上第一个分组交换网络以及现代互联网的祖先是”<code>ARPANET</code>“。</p>
<p>互联网非常快速的发展，如今不再只有几十台计算机联网，据估计，有接近100亿台联网设备，而且互联网会持续快速发展，特别是如今智能设备层出不穷，比如联网冰箱、恒温器，以及其他智能家电，它们组成了”<code>物联网</code>“。</p>
<h3 id="1-2：广域网-amp-高级协议"><a href="#1-2：广域网-amp-高级协议" class="headerlink" title="1.2：广域网&amp;高级协议"></a>1.2：广域网&amp;高级协议</h3><h4 id="1-2-1：广域网"><a href="#1-2-1：广域网" class="headerlink" title="1.2.1：广域网"></a>1.2.1：广域网</h4><p>计算机想要从网络里获取一段信息，首先要连到<code>局域网</code>，也叫<code>LAN</code>，你家WiFi连接着的所有设备，组成了局域网，局域网再到广域网，<code>广域网</code>也叫<code>WAN</code>，WAN的路由器一般属于你的”互联网服务提供商“，简称<code>ISP</code>，中国这种提供商主要有：<code>中国电信</code>、<code>中国移动</code>、<code>中国联通</code>等，广域网里，先连接到一个区域性路由器，这个路由器可能覆盖了一个街区，然后再连到一个更大的WAN，可能覆盖了整个城市，可能会再跳几次，但最终到达<code>互联网主干</code>，互联网主干由一群超大型、带宽超高的路由器组成。</p>
<p>为了从一个网站获取到html信息或者接口信息，请求数据包要先到互联网主干，沿着主干到达有对应内容的目标网站服务器，请求数据包到从你的电脑跳到目标网站服务器，可能要跳个十几次，让后找到对应的程序，将程序内对应路径里目标html文件或json接口数据再按照类似的方式传送回你的电脑上.</p>
<p>上节讲到，大的数据会被拆分成一个个的小数据包，然后经过不同的路由线路，最终抵达目的地，数据包要想在互联网上传输就要符合”互联网协议“的标准，简称IP，就像邮快递一样，快件的打包、重量都是要符合快递公司标准的，比如每个邮包必须要有发件地址和目标地址，而且地址是独一无二的（就像中国地名中按照省/市/县/镇/村的规则，没有任何一个地名是完全重复的），并且要求邮包的大小和重量也符合标准，违反这些标准和规范，邮包将无法被邮寄，事实上，IP数据包也是如此，因为IP是一个非常底层的协议。</p>
<p>数据包的头部只有目标地址：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-14.png?imageView2/0/w/500" alt="图14" title="图14"></p>
<p>仔细看上图的包结构，这意味着这个数据包抵达目标机器后，对方并不知道要把这个服务包给自己的哪个程序（是给tomcat这个http服务程序呢？还是给自己的文件处理程序呢？不知道，因为你只有一个IP头，它只能保证你的数据可以到达目标机器），因此需要在IP之上，开发更加高级的协议。</p>
<h4 id="1-2-2：UDP协议"><a href="#1-2-2：UDP协议" class="headerlink" title="1.2.2：UDP协议"></a>1.2.2：UDP协议</h4><p>这些高级协议里最简单最常见的叫”<code>用户数据报协议</code>“，简称<code>UDP</code>，有了这个协议，我们的数据包进化成了下面这样：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-15.png?imageView2/0/w/500" alt="图15" title="图15"></p>
<p>UDP协议头位于数据的前面，这个协议头里包含一些很重要的信息：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-16.png?imageView2/0/w/500" alt="图16" title="图16"></p>
<p>看，我们熟悉的端口号出现了。<strong>每个想访问网络的程序都要向操作系统申请一个端口号</strong>，比如tomcat这个java开发的http程序默认端口号就是<code>8080</code>，对外提供http服务的nginx程序的默认端口号就是<code>80</code>，当一个数据包到达时，接收方的操作系统就会读取UDP头里的端口号，如果看到PORT=8080，那么就把数据包交给tomcat，如果是80，则交给nginx，看，到现在我们就可以利用这俩协议互相配合，完成一个客户端到一个服务端上某个程序的访问了。</p>
<article class="message is-success"><div class="message-body">
<p>⭐️ 总结：</p>
<ol>
<li>IP负责把数据包送到正确的计算机</li>
<li>UDP负责把数据包送到正确的程序</li>
</ol>
</div></article>

<p>我们看到<code>图16</code>里UDP头除了PORT，我还列出了一个叫CHECK_NUM的东西，它叫做”<code>校验和</code>“，用于检查数据是否正确，正如校验和这个名字所暗示的，检查方式是把数据求和来对比，以下是个简单的例子：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-17.png?imageView2/0/w/900" alt="图17" title="图17"></p>
<p>值得注意的是，校验和只是一个16位的数（bit位），一旦累加和超过16位所能表达的最大范围，跟我们前面讲位运算时的位溢出一样，舍弃高位，保留低位。校验和用来判断数据的准确性，如果接收方收到的数据计算出的校验和跟发送方不一致，则说明数据被篡改过或由于电缆波动导致数据损坏过。不幸的是，UDP不提供数据修复或者数据重发的机制（划重点），接收到对方数据损坏后，一般只是扔掉（<code>丢包</code>），而且UDP无法得知数据包是否到达，发送方发送数据后无法感知对方是否已经接收到，这些特征听起来很糟糕，但有些程序其实并不在意这些问题，因为UDP又简单又快，对于那些有着高传输性能低完整性的系统（比如我们的日志系统和链路追踪系统），使用UDP协议开发服务端是个不错的选择，但是针对业务服务，对数据有着高精准性，不允许丢包的发生，对数据完整性要求极高，则不建议使用UDP，比如java开发的tomcat http服务程序，它就不是基于UDP协议完成通信传输的。</p>
<p>如果需要保证数据的完整性，即：所有数据必须到达，那么就可以使用”<code>传输控制协议</code>“，简称<code>TCP</code>。</p>
<h4 id="1-2-3：TCP-IP协议"><a href="#1-2-3：TCP-IP协议" class="headerlink" title="1.2.3：TCP/IP协议"></a>1.2.3：TCP/IP协议</h4><p>TCP和UDP一样，头部也在存数据前面，就像UDP一样，TCP头部也有”<code>端口号</code>“和”<code>校验和</code>“，但TCP有更高级的功能，我们这里只介绍重要的几个：</p>
<ol>
<li>TCP数据包有序号，15号后是16号，16号后是17号，以此类推，发上百万个数据包也是有可能的（事实上，TCP在建连时会确定初始序列号，被称作Initial Sequence Number，简称ISN，这个序号是根据系统时间来的，下面建连三次握手会讲到），还记得上面<code>图13</code>里的拆包后的到达顺序错乱的问题吗？序号可以使接收方把数据包排列成正确的顺序，即使到达顺序不同，TCP协议也能把顺序排对。</li>
<li>TCP要求接收方的电脑收到数据包并且”<code>校验和</code>“检查无误后（数据没有损坏）给发送方发一个确认码，代表收到了，确认码简称<code>ACK</code>，得知上一个数据包成功抵达后，发送方会发下一个数据包：</li>
</ol>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-18.png?imageView2/0/w/600" alt="图18" title="图18"></p>
<p>数据包2在第一次发送时可能由于网络延迟，可能中途发送失败，这不重要，重要的是发送方确实没有收到接收方的ACK消息，此时发送发会重试。注意，这样有可能发送重复的数据包，因为没有收到ACK并不意味着接收方100%没有收到数据包2，好在我们有TCP序列号，如果收到重复序列号的数据包就会删掉，只保留一个。<br><code>图18</code>里看到的是一个个的数据包发送，但事实上，TCP是支持多个数据包同时发送的然后收取多个ACK码的，这大大增加了效率，不用浪费时间等待确认码：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-19.png?imageView2/0/w/600" alt="图19" title="图19"></p>
<p>有意思的是，确认码的成功率和来回时间可以推测网络的拥堵程度，TCP利用这个信息，调整同时发包的数量，解决拥堵问题（可以了解下<a href="https://www.cnblogs.com/coder-programming/p/10627746.html">TCP的窗口滑动协议</a>），简单来说，TCP可以处理乱序和丢失数据包问题，丢了就重发，此外还可以根据拥堵情况自动调整传输率，相当厉害。你可能会奇怪，既然TCP那么厉害，为什么还有人用UDP呢？TCP最大的缺点是那些<code>ACK确认码</code>，交互的数据包的数量<code>翻了一倍</code>，但并没有传输更多信息，有时候这种代价是不值得的，特别是对时间要求很高的程序，比如前面提到的<code>日志系统</code>和<code>链路追踪系统</code>，它们可能对数据完整性要求没有业务系统那么高，但是传输性能一定要保证高速，这时候就特别适合UDP传输协议。<br><code>图18</code>和<code>图19</code>都是在TCP建连后的数据传输阶段，在这之前，你要想在TCP/IP上传输数据首先要做的就是建连，建连需要三次握手，如果数据传输完毕，数据发送方不会再和数据接收方有任何交互，这是其中一方会断开这个连接，这时又需要通过四次挥手来断开连接：<a href="https://lotabout.me/2019/TCP-connection-establish-and-termination/">三次握手、四次挥手</a></p>
<h4 id="1-2-4：DNS服务"><a href="#1-2-4：DNS服务" class="headerlink" title="1.2.4：DNS服务"></a>1.2.4：DNS服务</h4><p>这个大家应该很熟悉了，简单来说就是互联网的一个特殊服务，负责把域名和某个IP地址对应起来，我们并不希望在访问网站时输入一大串的数字，往往我们希望每个网站都有个自己的名字，毕竟bilibili.com记起来可比什么xxx.xxxx.xxx.xx容易多了。DNS就是做这个的，它可以将你记下来的域名解析出来它对应的IP地址，一般DNS服务器是互联网供应商提供的，DNS会查表，如果域名存在，就返回IP地址。你在浏览器输入bilibili.com就会解析到具体的一个IP地址，然后浏览器会给这个IP地址发请求，每个请求的数据传输都会基于一个或多个TCP连接完成，上层解析数据的工作则交给HTTP这个应用层协议去做。</p>
<h4 id="1-2-5：网络协议分层"><a href="#1-2-5：网络协议分层" class="headerlink" title="1.2.5：网络协议分层"></a>1.2.5：网络协议分层</h4><p><strong>物理层：</strong>之前说过的电缆、无线电信号这些属于物理层</p>
<p><strong>数据链路层：</strong>负责操控物理层，数据链路层有包含媒体访问控制地址（MAC地址），碰撞检测（之前说过的传输冲突），指数退避以及一些其他的底层协议，在往上一层是网络层。</p>
<p><strong>网络层：</strong>负责各种报文交换和路由</p>
<p><strong>传输层：</strong>上面刚讲的TCP和UDP都属于传输层协议，具体来说传输层负责在计算机之间进行点对点的传输（port to port），而且还会检测和修复错误。</p>
<p><strong>会话层：</strong>利用TCP/UDP来创建连接，传递信息，然后关掉连接，这一整套叫”<strong>会话</strong>“</p>
<p><strong>表示层&amp;应用程序层：</strong>HTML解码、浏览器等。</p>
<p>让我们来看看详细的分层结构图，目前有两种分层方式，我列举出一些具体的实现协议：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-20.png?imageView2/0/w/600" alt="图20" title="图20"></p>
<p>这个概念性框架，把网络通信划分成多层，每一层处理各自的问题，如果不分层，直接从上到下捏在一起实现网络通信，是完全不可能的，看，这个过程也是抽象&amp;分层，跟java里的抽象分层一样，软件分层也是同样的道理，通过抽象和分层让科学家和工程师们能各自分工同时改进多个层，不被整体复杂度难倒。</p>
<p>但我们目前会以<code>TCP/IP协议</code>为中心分的粒度更加粗，只有<code>四层</code>：</p>
<p><strong>应用层：</strong>最接近我们软件开发的一层，需要软件工程师亲自设计实现的一层，我们常见的有HTTP、HTTP2、FTP。</p>
<p><strong>传输层：</strong>利用应用层协议打包好的数据，通过传输层传输，就跟我们前面解析TCP和UDP工作流程时是一样的，它们只用来发送数据包。</p>
<p><strong>网络层：</strong>负责将数据包运送至互联网，传输到目标机器。</p>
<p><strong>网际接口层：</strong>包含了数据链路层和物理层。</p>
<h3 id="1-3：万维网"><a href="#1-3：万维网" class="headerlink" title="1.3：万维网"></a>1.3：万维网</h3><h4 id="1-3-1：万维网简介"><a href="#1-3-1：万维网简介" class="headerlink" title="1.3.1：万维网简介"></a>1.3.1：万维网简介</h4><p>万维网不是互联网！万维网不是互联网！万维网不是互联网！尽管人们经常混用这两个词，万维网在互联网之上运行，互联网之上还有A站B站、知乎微博、王者荣耀等，互联网是传递数据的管道，各种程序都会用，其中传输最多数据的程序是万维网，分布在全球上百万个服务器上，你可以用浏览器访问万维网，本节会详细介绍万维网。</p>
<h4 id="1-3-2：超链接"><a href="#1-3-2：超链接" class="headerlink" title="1.3.2：超链接"></a>1.3.2：超链接</h4><p>万维网的最基本单位，是单个页面，页面有内容，也有去往其他页面的链接，这些链接叫做”超链接“，大家都见过：可以点击的文字或图片，点击后把你送往另一个页面，这些超链接行成巨大的互联网络，这就是万维网名字的由来，现在说起来觉得很简单，但在超链接做出来之前，计算机上每次想看另一个信息时，你需要在文件系统中找到它，或是把地址输入搜索框，但有了<code>超链接</code>，你可以在相关主题间轻松切换，比如这样：（<a href="https://www.baidu.com/">对，点一下我，你就可以离开我去百度了</a>）。</p>
<p>超链接的价值早在1945年就被Vannevar Bush意识到了，他解释道：将两样东西联系到一起的过程十分重要，在任何时候，当其中一件东西进入视线，只需要点一下按钮，立马就能回忆起另一件，1945年的时候计算机连个显示屏都没有，所以这个想法在当时是非常超前的，因为文字超链接是如此的强大，它得到了一个同样厉害的名字：<code>超文本</code>。</p>
<p>如今超文本最常指向的，是另一个网页，然后网页由浏览器渲染（下面会详细讲），为了使网页能相互连接，每个网页需要一个唯一的地址，这个地址叫”<code>统一资源定位器</code>“，简称<code>URL</code>（这东西很熟悉吧）。</p>
<h4 id="1-3-3：定位一个超文本页面"><a href="#1-3-3：定位一个超文本页面" class="headerlink" title="1.3.3：定位一个超文本页面"></a>1.3.3：定位一个超文本页面</h4><p>结合我们前面介绍的，我们来看看浏览器如何定位到一个超文本信息：</p>
<p>假如你要访问：<a href="https://www.bilibili.com/anime">https://www.bilibili.com/anime</a></p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-21.png?imageView2/0/w/1024" alt="图21" title="图21"></p>
<p>这个时候会再次帮你巩固下TCP/IP的作用，我们常说的”建连“其实就是指TCP/IP连接的建立，没有TCP/IP连接，你的数据就无法和服务端进行准确的点对点的交互，而负责把你数据输送到对端又是通过基于IP协议的路由功能完成的，看，又串起来了。每一层网络协议都在我们上网时承载着不同的作用。</p>
<article class="message is-success"><div class="message-body">
<p>⚠️ 注意：图里虽然管TCP叫长连接，因为TCP在大部分应用层协议下都是不断开的，但是！但是！但是！由于HTTP协议的实现，TCP会很快断掉，你知道吗？TCP每次建连需要三次握手，下次访问时发现TCP已断开，访问前就会再次建连经历一遍三次握手，简单来说就是影响性能，这也是HTTP协议的一个弊端，所以后来HTTP协议通过keep-alive的方式进行优化，让长连接在断开前尽可能多的被复用。</p>
</div></article>

<p>依照这个流程，我们重点讲一下位于最上层的协议：<code>HTTP超文本传输协议</code>。</p>
<h4 id="1-3-4：HTML、HTTP协议"><a href="#1-3-4：HTML、HTTP协议" class="headerlink" title="1.3.4：HTML、HTTP协议"></a>1.3.4：HTML、HTTP协议</h4><p>首先，它是一个应用层协议，位于网络通信的最上层，下层仍然通过TCP/IP协议完成网络传输，那么HTTP是什么样的一种协议呢？它在通信过程里起到的作用是什么呢？</p>
<p>HTTP的第一个标准，HTTP0.9，创建于1991年，当时只有一个指令：GET，幸运的是，这对当时来说也够用，如<code>图21</code>，因为我们想要的是b站的/anime页面，所以我们向服务器发送指令：GET /anime，该指令以ASCII码发送至Web服务器，服务器会返回该地址对应的网页，然后浏览器将其渲染到屏幕上，此时在该页面用户再次点了另一个链接，计算机会重新发送一个GET请求，你在浏览网站时，这个过程会不断重复。在之后的版本，HTTP添加了状态码，状态码放在服务端返回消息体的前面，举例，状态码200代表”网页找到了，给你“，状态码400~499代表客户端出错，比如网页不存在，也就是可怕的404错误（-_-||）。</p>
<p>超文本的存储和发送都是以普通文本形式进行，比如，编码有可能是ASCII码或者UTF-16，因为如果只有纯文本，就无法表明什么是链接，什么不是链接，所以有必要开发一种标记方法，于是超文本标记语言HTML就这样诞生了（看，我们甚至讲到了前端），HTML第一版的版本号是0.8，创建于1990年，有18种HTML指令，仅此而已，我们来做一个网页吧！</p>
<figure class="highlight html"><figcaption><span>代码块1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">这是内容，<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.bilibili.com"</span>&gt;</span>这是超链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>h1就是一个HTML指令，它可以告诉浏览器，被它包裹的内容的字体需要变成1号标题大小，而a指令可以令被包裹的内容跳到其他页面。 </p>
<p>这样，我们的HTML页面就完成了，把它保存到一个记事本里面，然后把记事本的后缀改成.html，它就可以运行在浏览器上了，说白了，你请求一个网站也是类似的道理，只不过需要走网络，将目标网站对应的HTML页面拿到。</p>
<p>最新版的HTML、HTML5，有100多种标签指令，图片标签、表格标签、表单标签、按钮标签等等，还有其他相关技术就不说了，比如层叠样式表（CSS）和JavaScript，这俩可以加进网页，嵌入进你的HTML代码里，做一些更加厉害的事情。</p>
<p>让我们回到浏览器，网页浏览器可以和网页服务器（HTTP服务器）通信，浏览器不仅获取网页和媒体，获取后还负责显示。</p>
<h4 id="1-3-5：浏览器、web服务器的发展史"><a href="#1-3-5：浏览器、web服务器的发展史" class="headerlink" title="1.3.5：浏览器、web服务器的发展史"></a>1.3.5：浏览器、web服务器的发展史</h4><p>浏览器：基于HTTP协议完成和web服务器的网络通信，并将服务端返回的超文本内容进行渲染展示。</p>
<p>web服务器：支持HTTP协议的一个服务端程序，对，它只是一个服务器上运行的一个拥有端口号的程序而已，就像前面讲的网络通信一样，因为它支持HTTP协议的解析和封装传输，因此浏览器可以和它进行无障碍通信，这个流程简单画一下就是下面这样：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-22.png?imageView2/0/w/1024" alt="图22" title="图22"></p>
<p>上面省去了DNS这一步，对浏览器和web服务器程序通信的整个逻辑流程，仔细分析下，为什么web server会知道浏览器想要访问哪个文件呢？以及浏览器如何知道服务端的响应结果的？万一服务端找不到该咋办？这就是HTTP协议起到的作用，按照HTTP协议打包的数据，会告诉服务端当前请求资源的方式（<code>GET</code>、<code>POST</code>），还会告诉服务端请求的路径和参数，根据路径和参数找到对应的文件，然后包装成HTTP响应数据，返回给浏览器，如果没找到对应的路径，则返回404错误码，这时浏览器就知道了服务端找不到它要请求的界面。</p>
<p>看到这里，知道什么是应用层协议了吧？所谓应用层协议，其实就是软件内部处理对端数据时约定好的一种格式，便于符合同一种通信协议的两种软件相互通信（比如浏览器和web服务器程序都属于某种软件，或称应用，它们为什么可以顺利处理彼此通过TCP/IP传来的数据呢？因为它们都支持HTTP这种应用层协议，解析规则一致，所以它们都可以理解对方，比喻成人的话，就是他们俩虽然不是同一类人，但是他们俩是一个国家的人，能够听懂彼此的语言，而语言相对于人类来讲，也是一种”协议“性的东西）。</p>
<p>第一个浏览器和服务器，是<a href="https://zh.wikipedia.org/wiki/蒂姆·伯纳斯-李">Tim Berners-Lee</a>在1990年写的，一共花了2个月，那时候他在瑞士的”欧洲核子研究所“工作，为了做出来，他同时建立了几个最基本的网络标准：<code>URL（概念）</code>、<code>HTML（语言）</code>、<code>HTTP（协议）</code>，两个月。。就。。过于优秀！不过公平点说，他研究超文本系统已经有十几年了，和同事在CERN内部使用了一阵子后，在1991年发布了出去，万维网就此诞生！重要的是，万维网有开放标准，大家都可以开发新的服务器和新的浏览器，因此”伊利诺伊大学香槟分校“的一个小组，在1993年做了<a href="https://zh.wikipedia.org/wiki/Mosaic">Mosaic浏览器</a>，它是第一个可以在文字旁边显示图片的浏览器，之前的浏览器要单开一个页面专门展示图片，还引进了书签等新功能，界面友好，使它一度很受欢迎，它长这样：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-23.png" alt="图23" title="图23"></p>
<p>尽管以现在的眼光看上去很呆板，但和如今的浏览器长得也差不多。</p>
<p>1990年代末有许多浏览器面世：<code>IE</code>、<code>Opera</code>、<code>OmniWeb</code>、<code>Mozilla</code>，当然也有很多基于HTTP协议的web服务器面世，比如<code>Apache</code>（重点）和微软互联网信息服务（IIS）。</p>
<p>基于这些成果，每天都有新网站冒出来，如今的网络巨头，比如<code>亚马逊</code>、<code>eBay</code>，创建于1990年代中期，而在中国，1998年诞生了<code>腾讯</code>，1999年诞生了<code>阿里巴巴</code>，那是个黄金时代！</p>
<h4 id="1-3-6：第一个爬虫程序-amp-第一个搜索引擎"><a href="#1-3-6：第一个爬虫程序-amp-第一个搜索引擎" class="headerlink" title="1.3.6：第一个爬虫程序&amp;第一个搜索引擎"></a>1.3.6：第一个爬虫程序&amp;第一个搜索引擎</h4><p>随着万维网日益繁荣，人们越来越需要搜索，如果你知道网站地址，比如bilibili.com，直接输入浏览器就行，但如果不知道地址呢？比如想找可爱猫咪的图片，现在就要！去哪里找呢？起初人们会维护一个目录，链接到其它网站，其中最有名的叫”Jerry和David的万维网指南“，1994年改名为<code>Yahoo</code>（没错，就是早期的雅虎搜索），随着网络越来越大，人工编辑的目录变得不便利，所以开发了搜索引擎。</p>
<p>长得最像现代搜索引擎的最早搜索引擎，名叫<a href="https://zh.wikipedia.org/wiki/JumpStation">JumpStation</a>，由<a href="https://baike.baidu.com/item/Jonathan%20Fletcher">Jonathan Fletcher</a>于1993年在<a href="https://zh.wikipedia.org/wiki/斯特灵大学">斯特林大学</a>创建，它有3个部分：</p>
<ol>
<li>第一个是<code>爬虫</code>，一个跟着链接到处跑的软件，每到看到新链接，就加进自己的列表里</li>
<li>第二部分是不断扩张的<code>索引</code>，记录访问过的网页上，出现过哪些词</li>
<li>最后一部分，是查询索引的<code>搜索算法</code>，比如我输入”猫“，那么每个有”猫“这个词的网页都会出现</li>
</ol>
<p>早期搜索引擎的排名方式非常简单，取决于搜索词在页面上的出现次数，刚开始还行，直到有人开始钻空子，比如在页面上写几百个”猫“，把人们吸引过来，谷歌的成名的很大一个原因是创造了一个聪明的算法来规避这个问题。与其信任网页上的内容，搜索引擎会看其他网站，有没有链接到这个网站，如果只是写满”猫“的垃圾网站，没人会愿意指向它，如果有关于”猫“的有用内容，有网站会指向它，所以这些”<code>反向链接</code>“的数量，特别是有信誉的网站会特别多，反向链接的数量代表了网站的质量。</p>
<p>Google一开始时是1996年<a href="https://zh.wikipedia.org/wiki/史丹佛大學">斯坦福大学</a>一个叫<a href="https://web.archive.org/web/19961224105215/http://huron.stanford.edu/">BackRub</a>的研究项目，两年后分离出来，演变成如今的<a href="https://zh.wikipedia.org/wiki/Google">谷歌</a>。</p>
<h3 id="1-4：我自己的个人电脑联通网络后可以被别的电脑通过ip-port访问到吗？"><a href="#1-4：我自己的个人电脑联通网络后可以被别的电脑通过ip-port访问到吗？" class="headerlink" title="1.4：我自己的个人电脑联通网络后可以被别的电脑通过ip+port访问到吗？"></a>1.4：我自己的个人电脑联通网络后可以被别的电脑通过ip+port访问到吗？</h3><p><strong>我们的常识告诉我们，不行！</strong></p>
<p>为什么呢？前面说到了局域网，或者说我们管它叫内网，我们的个人电脑只是接在了局域网里。一个公司里的电脑，一个学校里的电脑，都可以组成一个局域网，而一个局域网内的计算机，都会有个内网IP，它们通过<code>NAT（网络地址转换）</code>实现内网的IP地址与公网的IP地址之间的相互转换，将大量的内网IP地址转换为一个或少量的公网IP地址，减少对公网IP地址的占用，NAT的最典型的应用是：在一个局域网内，只需要一台计算机连接上Internet，就可以利用NAT<code>共享Internet连接</code>，使局域网内其他计算机也可以上网。使用NAT协议，局域网内的计算机可以访问Internet上的计算机，但Internet上的计算机无法访问局域网内的计算机，这就是你连上局域网的电脑为什么不可以被别人访问的原因。</p>
<p>那么如何让自己电脑上的某个程序让别人可以访问到呢？需要配置部署一个公网IP地址，公网IP是指以公网连接Internet上的非保留地址。</p>
<p>公网、内网是两种Internet的接入方式，公网的计算机和Internet上的其他计算机是可以随意互相访问的。</p>
<article class="message is-success"><div class="message-body">

<p>⚜️ <strong>总结：</strong></p>
<ol>
<li>通过公网部署的计算机可以访问互联网里的任意计算机。</li>
<li>仅链接进局域网的计算机可以被公网计算机连接并访问，但是无法被别的计算机主动连接访问。</li>
</ol>
<p>所以如果你想要建设一个个人站，首先要找到一个接入公网的计算机当做服务器，否则别人是无法访问你的，这种计算机在哪里买到呢？当然是<a href="https://cn.aliyun.com/product/ecs?utm_content=se_882113&gclid=EAIaIQobChMIr4PJo8636AIVlKDsCh1YkAoWEAAYASABEgIu9fD_BwE">阿里云</a>啊~（不是广告，腾讯云也提供这种服务，这些服务按照职能不同还分了很多种类，相比阿里云这种提供全方位服务器的商户，七牛云和又拍云就只提供云存储和CDN服务）</p>
<p>如果你在阿里云购买了一台服务器，他会给你两个ip，一个是<code>公网ip</code>，一个是<code>内网ip</code>：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-aliyun.png?imageView2/0/w/1024" alt="阿里云控制台" title="阿里云控制台"></p>
<p>你如果也注册了域名（在中国需要给域名完成<code>备案</code>，相当于给你的域名搞个“身份证”），就可以将公网ip绑定你的域名让别人访问了~</p>
</div></article>

<h3 id="1-5：结束语"><a href="#1-5：结束语" class="headerlink" title="1.5：结束语"></a>1.5：结束语</h3><p>第一部分的内容到这里就结束了，最后我想讲一个词，你最近可能经常听到，<code>网络中立性（Net Neutrality）</code>，现在的你对<code>数据包</code>、<code>路由</code>、<code>万维网</code>应该有了个大体的认识，足够你理解这个争论的核心点，至少从技术角度上来说。</p>
<p>简单说网络中立性是应该平等对待所有数据包，不论这个数据包是我的邮件，或者是你正在看的视频，速度和优先级应该是一样的，但很多公司会乐意让他们的数据优先到达，拿<a href="https://zh.wikipedia.org/wiki/康卡斯特">Comcast</a>举例，他们不仅是大型互联网服务提供商，而且拥有很多家电视频道，比如NBC、The Weather Channel等，可以在线观看，我不是特意要找Comcast麻烦，但要是没有网络中立性，Comcast可以让自己的内容优先到达，节流其他的线上视频（节流是指故意给更少带宽和更低的优先级）。</p>
<p>支持网络中立性的人说，没有中立性后，服务商可以推出提速的”高级套餐“，给剥削性商业模式埋下种子，互联网服务供应商称为信息的”守门人“，他们有着强烈的动机去碾压对手，另外，网飞和谷歌这样的大公司可以花钱买特权，而小公司，比如刚成立的创业公司将会处于劣势，阻止了创新。</p>
<p>另一方面，从技术原因看，也许你会希望不同的数据传输速度不同，你希望b站看视频优先级更高，而企业微信发的邮件慢几秒没关系，而反对网络中立性的人则认为，市场竞争会阻碍不良行为，如果供应商把客户喜欢的网站降速，客户会选择离开供应商，这场争辩还会持续很久，你应该学会去独立思考，主动获取一些信息之后再发表自己的看法，因为网络中立性十分复杂和广泛。</p>
<h2 id="二、序列化"><a href="#二、序列化" class="headerlink" title="二、序列化"></a>二、序列化</h2><h3 id="2-1：序列化是做什么的？"><a href="#2-1：序列化是做什么的？" class="headerlink" title="2.1：序列化是做什么的？"></a>2.1：序列化是做什么的？</h3><p>回到我们之前讲过的TCP/IP传递的数据包的基本结构，它长下面这样：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-24.png?imageView2/0/w/500" alt="图24" title="图24"></p>
<p>抛去带领我们数据路由的IP协议头和找到具体程序的TCP协议头，剩下的部分就是我们所要传输的具体数据流，我们假设现在浏览器发起一个请求，为了方便表述，这个请求只发一个数据包到我们的web server（端口号假设为80）程序上，它的过程是这样的：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-25.png?imageView2/0/w/1024" alt="图25" title="图25"></p>
<p>前面说过，浏览器和服务器都是支持解析HTTP协议的（这里是不是更加理解为什么HTTP是应用层协议了呢？你看看上图里HTTP的解析，都是发生在实际应用里解析的），但是实际参与两个应用做业务处理的这些业务数据才是我们最终最终需要关心的数据，因为它们关系着我们的业务代码的走向，那么业务DATA也是个二进制字节流啊，那可怎么办？这意味着浏览器和服务端都无法解析出最终的业务数据应该是什么，举个我们常用的例子（为了方便描述问题，我们省去了应用层以下的流程）：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-26.png?imageView2/0/w/700" alt="图26" title="图26"></p>
<p>我们抽象了两种常用的HTTP请求方式，一种是获取信息的GET请求，一种是提交表单信息的POST请求，但是你会发现，GET在根据id查到season信息后，需要返回给浏览器，而浏览器也必须得识别后端程序发过来这个字节流的数据结构，才能进一步做业务处理，同样的，POST请求这个问题则表现得更加彻底，首先浏览器表单填写完成后，传的参数也是一个结构体，服务端处理完成后也会返回一个应答结构体供浏览器做自己的业务处理。</p>
<p>好的，这个过程我们梳理了下，回想下，浏览器里负责发请求以及解析后端返回数据的语言叫啥？嗯，就是JavaScript，而我们前面说过，web server又是由别的语言来实现的，比如tomcat，它是由java开发的，那现在问题简化多了：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-27.png?imageView2/0/w/600" alt="图27" title="图27"></p>
<p>上图的问题，被我们用json解决了，这就是json的意义，json是一个跨语言的序列化方式，js本身就支持json编解码，java也有自己的json编解码工具：<code>fastjson</code>、<code>gson</code>等等，这样，JS可以解析JAVA传过来的字节流，JAVA也可以解析JS传来的字节流。</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-28.png?imageView2/0/w/850" alt="图28" title="图28"></p>
<p>根据上图，简单理解就是：</p>
<ul>
<li>序列化就是以某种算法方式让自己的数据结构对象变成一个二进制字节流</li>
<li>反序列化就是以某种算法方式就是让一个以同样算法编码的字节流变成自己的一个数据结构对象</li>
<li>说人话就是，java可以让浏览器传来的字节流变成自己的一个类的对象，类就是java的数据结构，而js也可以通过ajax获取到的服务端字节流变成自己可识别的对象结构。</li>
</ul>
<p>这种算法就是我们常说的序列化算法，目前有java自己的序列化算法、json、protobuf等。</p>
<p>发散下思维，如果<code>图27</code>里浏览器通信的也是JAVA代码写的程序而不是JS，会不会也有序列化问题？当然有啦，说到底为什么要序列化反序列化，还不是因为网络传输只能是二进制字节流，只要跨进程了，这个问题就固然存在，我们刚刚列举了一些序列化方式，json做到了跨语言，比如js支持，java也支持，go也支持，php也支持，所以json很厉害，而java也有自己的序列化方式，这种方式解码程序仅适用于java程序自己，它做不到让js也理解。</p>
<h3 id="2-2：JAVA是如何做序列化的？"><a href="#2-2：JAVA是如何做序列化的？" class="headerlink" title="2.2：JAVA是如何做序列化的？"></a>2.2：JAVA是如何做序列化的？</h3><p>通过上一节的理解，序列化就是让自己变成一串二进制字节流，反序列化就是让一串二进制字节流变成一个java对象，那我们现在用java的传统艺能来做下这个事情，还记得之前画的java io家族继承图吗？java用来序列化的内容也属于这一块的内容，它是由这俩类来完成的：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-29.png?imageView2/0/w600" alt="图29" title="图29"></p>
<p>我们不能因此做一个网络传输，太费劲了，我们可以利用文件io来做这个事情（本质上没什么不同，读网络传进来的io字节流跟读文件里面的字节流效果是一致的，只不过一个是从网关接收数据，一个是从文件接收数据），我们定义一个类：</p>
<figure class="highlight java"><figcaption><span>代码块2</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Season</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123; <span class="comment">//通过实现Serializable接口，来标记该对象是允许被序列化的</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> season_id;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> String index; <span class="comment">//被transient修饰的字段不参与序列化和反序列化</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSeason_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> season_id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSeason_id</span><span class="params">(<span class="keyword">int</span> season_id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.season_id = season_id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.title = title;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIndex</span><span class="params">(String index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.index = index;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>代码块3</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//new一个Season对象</span></span><br><span class="line">        Season season = <span class="keyword">new</span> Season();</span><br><span class="line">        season.setSeason_id(<span class="number">1</span>);</span><br><span class="line">        season.setTitle(<span class="string">"寒蝉鸣泣之时"</span>);</span><br><span class="line">        season.setIndex(<span class="string">"索引1"</span>);</span><br><span class="line">        serializable(season); <span class="comment">//把它序列化到一个文件里去</span></span><br><span class="line"> </span><br><span class="line">        Season season2 = deSerializable(); <span class="comment">//从文件读取被序列化好的season对象的字节流，然后反序列化成一个新的对象</span></span><br><span class="line">        System.out.println(<span class="string">"season_id = "</span> + season2.getSeason_id() + <span class="string">"    title = "</span> + season2.getTitle() + <span class="string">"     index = "</span> + season2.getIndex());</span><br><span class="line">        System.out.println(season == season2); <span class="comment">//这是俩不同的对象，结果为false</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//序列化</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">serializable</span><span class="params">(Season season)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(<span class="string">"/Users/sunqinwen/Documents/season.txt"</span>)));</span><br><span class="line">        <span class="comment">//我们把这个对象写进对应的文件</span></span><br><span class="line">        oos.writeObject(season);</span><br><span class="line">        System.out.println(<span class="string">"对象序列化成功！"</span>);</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//反序列化</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Season <span class="title">deSerializable</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(<span class="string">"/Users/sunqinwen/Documents/season.txt"</span>)));</span><br><span class="line">        <span class="comment">//我们把文件里的字节流读取进来进行反序列化</span></span><br><span class="line">        Season result = (Season) ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight bash"><figcaption><span>代码块4</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">对象序列化成功！</span><br><span class="line">season_id = 1    title = 寒蝉鸣泣之时     index = null</span><br><span class="line"><span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>可以看到，被transient修饰的index字段并没有参与序列化和反序列化，现在让我们看下season.txt这个文件里的内容：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-30.png?imageView2/0/w1000" alt="图30" title="图30"></p>
<p>你没有必要读懂这段内容，你只需要知道，这块内容是java按照某种规则生成的内容，这段内容被以字节流的方式读进一个java程序里，再通过java反序列化类进行解码，它就可以得到一个你想要的对象。</p>
<h3 id="2-3：FastJson与json序列化"><a href="#2-3：FastJson与json序列化" class="headerlink" title="2.3：FastJson与json序列化"></a>2.3：FastJson与json序列化</h3><p>我们在<code>2.1</code>里讲过json是一个跨语言的序列化方式，它有着人可以读懂的字符串结构，将这些符合json结构的字符直接录入文件，然后让java读取出来，通过java的fastjson工具包，就可以将这个json字节流变成你java程序内对应的数据结构（类）的对象，fastjson是一个第三方库，使用前需要在你的gradle文件里引入它：</p>
<figure class="highlight groovy"><figcaption><span>代码块5</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile <span class="string">group:</span> <span class="string">'com.alibaba'</span>, <span class="string">name:</span> <span class="string">'fastjson'</span>, <span class="string">version:</span> <span class="string">'1.2.67'</span>     <span class="comment">//在你gradle文件的dependencies下加入这段代码，gradle就会帮你自动依赖进来它的jar包</span></span><br></pre></td></tr></table></figure>

<p>然后我们将上面的例子来利用<code>fastjson</code>改编下：</p>
<figure class="highlight java"><figcaption><span>代码块6</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//new一个Season对象</span></span><br><span class="line">        Season season = <span class="keyword">new</span> Season();</span><br><span class="line">        season.setSeason_id(<span class="number">1</span>);</span><br><span class="line">        season.setTitle(<span class="string">"寒蝉鸣泣之时"</span>);</span><br><span class="line">        season.setIndex(<span class="string">"索引1"</span>);</span><br><span class="line">        serializable(season); <span class="comment">//把它序列化到一个文件里去</span></span><br><span class="line"> </span><br><span class="line">        Season season2 = deSerializable(); <span class="comment">//从文件读取被序列化好的season对象的字节流，然后反序列化成一个新的对象</span></span><br><span class="line">        System.out.println(<span class="string">"season_id = "</span> + season2.getSeason_id() + <span class="string">"    title = "</span> + season2.getTitle() + <span class="string">"     index = "</span> + season2.getIndex());</span><br><span class="line">        System.out.println(season == season2); <span class="comment">//这是俩不同的对象，结果为false</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//json序列化，我们利用fastjson将season对象序列化到文件里</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">serializable</span><span class="params">(Season season)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span>[] seasonByte = JSONObject.toJSONBytes(season);</span><br><span class="line">        Path path = Paths.get(<span class="string">"/Users"</span>, <span class="string">"sunqinwen"</span>, <span class="string">"Documents"</span>, <span class="string">"seasonJson.txt"</span>);</span><br><span class="line">        <span class="keyword">if</span> (!Files.exists(path)) &#123; <span class="comment">//若文件不存在</span></span><br><span class="line">            Files.createFile(path); <span class="comment">//创建文件</span></span><br><span class="line">        &#125;</span><br><span class="line">        Files.write(path, seasonByte); <span class="comment">//将序列化好的字节流存入文件</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//json反序列化，我们利用fastjson将文件里的字节流重新转换成Season对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Season <span class="title">deSerializable</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Path path = Paths.get(<span class="string">"/Users"</span>, <span class="string">"sunqinwen"</span>, <span class="string">"Documents"</span>, <span class="string">"seasonJson.txt"</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] seasonByte = Files.readAllBytes(path); <span class="comment">//读取出来所有的字节</span></span><br><span class="line">        <span class="keyword">return</span> JSONObject.parseObject(seasonByte, Season<span class="class">.<span class="keyword">class</span>)</span>; <span class="comment">//反序列化成对应类型的对象</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight bash"><figcaption><span>代码块7</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">season_id = 1    title = 寒蝉鸣泣之时     index = null</span><br><span class="line"><span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>让我们来看下seasonJson.txt：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-31.png?imageView2/0/w1000" alt="图31" title="图31"></p>
<p>我们终于可以看懂了，这就是json有魅力的地方，它实际的格式就是便于人类阅读的，实际上实现了json序列化的工具也是按照这种格式来解析这些json串的，json就不过多介绍了，实际上在测试当中，你已经见过太多复杂的结构体了。</p>
<p>但是，json串如何和我们的java对象映射起来呢？我们来写一个复杂一点的java类：</p>
<figure class="highlight java"><figcaption><span>代码块8</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] nos;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Season&gt; seasons;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Season&gt; season_map;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] getNos() &#123;</span><br><span class="line">        <span class="keyword">return</span> nos;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNos</span><span class="params">(<span class="keyword">int</span>[] nos)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.nos = nos;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Season&gt; <span class="title">getSeasons</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> seasons;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSeasons</span><span class="params">(List&lt;Season&gt; seasons)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.seasons = seasons;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Season&gt; <span class="title">getSeason_map</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> season_map;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSeason_map</span><span class="params">(Map&lt;String, Season&gt; season_map)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.season_map = season_map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们来给它的一个对象赋值后再转成json串：</p>
<figure class="highlight java"><figcaption><span>代码块9</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Student student = <span class="keyword">new</span> Student();</span><br><span class="line">    student.setId(<span class="number">1</span>);</span><br><span class="line">    student.setName(<span class="string">"蛤蛤"</span>);</span><br><span class="line">    student.setAge(<span class="number">1000000</span>);</span><br><span class="line">    student.setNos(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;);</span><br><span class="line"> </span><br><span class="line">    Map&lt;String, Season&gt; seasonMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    Season season1 = <span class="keyword">new</span> Season();</span><br><span class="line">    season1.setSeason_id(<span class="number">1</span>);</span><br><span class="line">    season1.setTitle(<span class="string">"寒蝉鸣泣之时 第一季"</span>);</span><br><span class="line"> </span><br><span class="line">    Season season2 = <span class="keyword">new</span> Season();</span><br><span class="line">    season2.setSeason_id(<span class="number">2</span>);</span><br><span class="line">    season2.setTitle(<span class="string">"寒蝉鸣泣之时 第二季"</span>);</span><br><span class="line"> </span><br><span class="line">    seasonMap.put(<span class="string">"第1季"</span>, season1);</span><br><span class="line">    seasonMap.put(<span class="string">"第2季"</span>, season2);</span><br><span class="line">    student.setSeason_map(seasonMap);</span><br><span class="line"> </span><br><span class="line">    List&lt;Season&gt; seasons = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Season season3 = <span class="keyword">new</span> Season();</span><br><span class="line">    season3.setSeason_id(<span class="number">3</span>);</span><br><span class="line">    season3.setTitle(<span class="string">"火影忍者 疾风传"</span>);</span><br><span class="line"> </span><br><span class="line">    Season season4 = <span class="keyword">new</span> Season();</span><br><span class="line">    season4.setSeason_id(<span class="number">4</span>);</span><br><span class="line">    season4.setTitle(<span class="string">"少女终末旅行"</span>);</span><br><span class="line"> </span><br><span class="line">    seasons.add(season3);</span><br><span class="line">    seasons.add(season4);</span><br><span class="line"> </span><br><span class="line">    student.setSeasons(seasons);</span><br><span class="line"> </span><br><span class="line">    System.out.println(JSON.toJSONString(student)); <span class="comment">//利用fastjson这个JSON类的静态方法toJSONString，可以把一个对象转成json串</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果，我们格式化一下，是下面的字符串：</p>
<figure class="highlight json"><figcaption><span>代码块10</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"age"</span>: <span class="number">1000000</span>,</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"蛤蛤"</span>,</span><br><span class="line">    <span class="attr">"nos"</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    <span class="attr">"season_map"</span>: &#123;</span><br><span class="line">        <span class="attr">"第1季"</span>: &#123;</span><br><span class="line">            <span class="attr">"season_id"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">"title"</span>: <span class="string">"寒蝉鸣泣之时 第一季"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"第2季"</span>: &#123;</span><br><span class="line">            <span class="attr">"season_id"</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">"title"</span>: <span class="string">"寒蝉鸣泣之时 第二季"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"seasons"</span>: [&#123;</span><br><span class="line">        <span class="attr">"season_id"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">"title"</span>: <span class="string">"火影忍者 疾风传"</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="attr">"season_id"</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">"title"</span>: <span class="string">"少女终末旅行"</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在，仔细观察这个json串的每一项，给我们的Student类里的属性一一对比，你就会发现它们之间的映射关系。</p>
<h2 id="三、Tomcat"><a href="#三、Tomcat" class="headerlink" title="三、Tomcat"></a>三、Tomcat</h2><p>终于到了最令人兴奋的时刻了，之前了解了那么多网络知识，是我们写的业务代码发挥它意义的时刻了~</p>
<h3 id="3-1：Tomcat简介"><a href="#3-1：Tomcat简介" class="headerlink" title="3.1：Tomcat简介"></a>3.1：Tomcat简介</h3><p>用维基百科里的解释：</p>
<blockquote>
<p>Tomcat是由Apache软件基金会属下Jakarta项目开发的Servlet容器，按照Sun Microsystems提供的技术规范，实现了对Servlet和JavaServer Page（JSP）的支持，并提供了作为Web服务器的一些特有功能，如Tomcat管理和控制平台、安全局管理和Tomcat阀等。由于Tomcat本身也内含了HTTP服务器，因此也可以视作单独的Web服务器。</p>
</blockquote>
<p>说人话就是：Tomcat是基于java语言实现的一个基于HTTP协议的web服务器程序，你写的业务代码可以放到这个服务程序下面，然后你的业务代码就可以被别人通过<a href="http://xxx.xxx.xxx/path的方式调用到，触发到了！而这节课所讲述的HTTP协议编解码、json序列化你完全不需要关心，tomcat已经支持了，你现在要做的是，编写自己的业务代码，把它们放进去，放到tomcat的身体里就好了！很开心吧？作为程序员的幸福感油然而生，正是因为前辈们不断的铺路，我们不用自己开发一个支持http协议的服务器程序，因为前辈们提供了Spring，我们不用自己深入理解IOC和AOP思想，因为前辈们提供了Mybatis，我们不用苦恼通过传统JDBC读出来的数据无法直接转成java对象。这里提到的Spring和Mybatis又是切实参与你业务代码编写的类库集，被我们称为”框架“，有了它们，我们写起来企业级业务代码会非常的开心，这些后面会通过一个程序带大家慢慢了解，正是因为前人不断的努力，我们其实已经很省力了，喜欢折腾的程序员还会重复造轮子，试图撼动这些传统框架的地位（个人观点：喜欢创新是好事，但要找对点，没有技术革新的造轮子唯一的意义就是帮助你更深理解前辈们的思想）。">http://xxx.xxx.xxx/path的方式调用到，触发到了！而这节课所讲述的HTTP协议编解码、json序列化你完全不需要关心，tomcat已经支持了，你现在要做的是，编写自己的业务代码，把它们放进去，放到tomcat的身体里就好了！很开心吧？作为程序员的幸福感油然而生，正是因为前辈们不断的铺路，我们不用自己开发一个支持http协议的服务器程序，因为前辈们提供了Spring，我们不用自己深入理解IOC和AOP思想，因为前辈们提供了Mybatis，我们不用苦恼通过传统JDBC读出来的数据无法直接转成java对象。这里提到的Spring和Mybatis又是切实参与你业务代码编写的类库集，被我们称为”框架“，有了它们，我们写起来企业级业务代码会非常的开心，这些后面会通过一个程序带大家慢慢了解，正是因为前人不断的努力，我们其实已经很省力了，喜欢折腾的程序员还会重复造轮子，试图撼动这些传统框架的地位（个人观点：喜欢创新是好事，但要找对点，没有技术革新的造轮子唯一的意义就是帮助你更深理解前辈们的思想）。</a></p>
<h3 id="3-2：Servlet"><a href="#3-2：Servlet" class="headerlink" title="3.2：Servlet"></a>3.2：Servlet</h3><p>你以为你写的业务代码就那么容易放进Tomcat的身体里吗？不存在的，上面说了，Tomcat是一个Servlet容器，什么意思？就是说你写的代码必须要符合Servlet规范，至少你的程序入口得符合Servlet，同样的，我们摘一段维基百科里对它的描述：</p>
<blockquote>
<p>Servlet（Server Applet），全称Java Servlet，未有中文译文。是用Java编写的服务器端程序。其主要功能在于交互式地浏览和修改数据，生成动态Web内容。狭义的Servlet是指Java语言实现的一个接口，广义的Servlet是指任何实现了这个Servlet接口的类，一般情况下，人们将Servlet理解为后者。</p>
</blockquote>
<p>还记得我们前面讲过的类的继承多态以及接口吗？你可以这样理解，你的业务代码类得是Servlet的实现类，并且实现了它的一些方法后才可以被Tomcat识别并进入，这就是java多态的好处之一，你只要符合某种规范，就可以被别的符合同样规范的程序（本例指tomcat）所识别，你重写了里面的方法，别的程序会触发被你重写的方法，看！你的业务代码就这样被触发了！</p>
<h3 id="3-3：基于Servlet实现一个业务接口"><a href="#3-3：基于Servlet实现一个业务接口" class="headerlink" title="3.3：基于Servlet实现一个业务接口"></a>3.3：基于Servlet实现一个业务接口</h3><p>前面说了一大堆废话，太虚了，我们来新建一个gradle项目，编写一个返回一个对象json结构体的例子（其实沃特玛自己都忘了咋写了，回头学会用Spring Boot写一个同样的接口，你会唾弃现在这种干法的）。</p>
<h4 id="3-3-1：下一个tomcat先"><a href="#3-3-1：下一个tomcat先" class="headerlink" title="3.3.1：下一个tomcat先"></a>3.3.1：下一个tomcat先</h4><p>tomcat下载地址：<a href="https://tomcat.apache.org/download-80.cgi">https://tomcat.apache.org/download-80.cgi</a></p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-32.png?imageView2/0/w1000" alt="图32" title="图32"></p>
<p>找到属于你自己平台的那个即可，tomcat是不需要特别安装的，直接解压就能用。</p>
<p>它的目录长这样：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-33.png?imageView2/0/w1000" alt="图33" title="图33"></p>
<p>圈出来的是最重要的几个包，bin存放的是tomcat的核心功能，conf下放的是tomcat本身的配置，webapps就是存放你业务代码的地方了~当然正常开发时，你是不需要手动将你编译好的业务代码放进去的，IDEA已经帮你做到了，你需要做的是给IDEA指定一个tomcat路径，让IDEA知道你的tomcat程序在哪里，这样你的web程序在启动时，IDEA就可以帮你把它编译好的代码放到webapps下面了。</p>
<h4 id="3-3-2：添加依赖包"><a href="#3-3-2：添加依赖包" class="headerlink" title="3.3.2：添加依赖包"></a>3.3.2：添加依赖包</h4><p>我们在构建好的gradle项目里的build.gradle的dependencies里引入以下配置，引入servlet的jar包和fastjson的jar包：</p>
<figure class="highlight groovy"><figcaption><span>代码块11</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">compileOnly (<span class="string">group:</span> <span class="string">'javax.servlet'</span>, <span class="string">name:</span> <span class="string">'javax.servlet-api'</span>, <span class="string">version:</span> <span class="string">'4.0.1'</span>)</span><br><span class="line">compile (<span class="string">group:</span> <span class="string">'com.alibaba'</span>, <span class="string">name:</span> <span class="string">'fastjson'</span>, <span class="string">version:</span> <span class="string">'1.2.67'</span>)</span><br></pre></td></tr></table></figure>

<p>这样，你就可以使用servlet的包编写你的业务程序，之前讲过，通信时以字节做交互的话需要序列化，因为我们是一个输出信息的接口，所以我们选择使用json方式完成序列化，所以我们还需要引入一个json序列化工具fastjson用来做数据的序列化。</p>
<h4 id="3-3-3：编写业务代码"><a href="#3-3-3：编写业务代码" class="headerlink" title="3.3.3：编写业务代码"></a>3.3.3：编写业务代码</h4><p>我们这个接口的目标是，将一个复杂的java对象，传输给浏览器，我们仍然使用之前那个复杂的Student做，只不过我们要利用分层思想来做：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-34.png?imageView2/0/w1000" alt="图34" title="图34"></p>
<p>还记得我们之前在做一个简单的增删改查时那个例子里的业务分层模式吗？这里也是一样的，不过我们没有做service层，因为不需要，我们只是要将一个对象输送出去，没有任何特别的业务逻辑操作。</p>
<p>我们来看下Dao层的代码：</p>
<figure class="highlight java"><figcaption><span>代码块12</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDao</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//之前例子里给Student赋值的main方法里的逻辑，被抽象进了Dao层的一个方法里</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">getStudentInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        student.setId(<span class="number">1</span>);</span><br><span class="line">        student.setName(<span class="string">"蛤蛤"</span>);</span><br><span class="line">        student.setAge(<span class="number">1000000</span>);</span><br><span class="line">        student.setNos(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;);</span><br><span class="line"> </span><br><span class="line">        Map&lt;String, Season&gt; seasonMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Season season1 = <span class="keyword">new</span> Season();</span><br><span class="line">        season1.setSeason_id(<span class="number">1</span>);</span><br><span class="line">        season1.setTitle(<span class="string">"寒蝉鸣泣之时 第一季"</span>);</span><br><span class="line"> </span><br><span class="line">        Season season2 = <span class="keyword">new</span> Season();</span><br><span class="line">        season2.setSeason_id(<span class="number">2</span>);</span><br><span class="line">        season2.setTitle(<span class="string">"寒蝉鸣泣之时 第二季"</span>);</span><br><span class="line"> </span><br><span class="line">        seasonMap.put(<span class="string">"第1季"</span>, season1);</span><br><span class="line">        seasonMap.put(<span class="string">"第2季"</span>, season2);</span><br><span class="line">        student.setSeason_map(seasonMap);</span><br><span class="line"> </span><br><span class="line">        List&lt;Season&gt; seasons = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        Season season3 = <span class="keyword">new</span> Season();</span><br><span class="line">        season3.setSeason_id(<span class="number">3</span>);</span><br><span class="line">        season3.setTitle(<span class="string">"火影忍者 疾风传"</span>);</span><br><span class="line"> </span><br><span class="line">        Season season4 = <span class="keyword">new</span> Season();</span><br><span class="line">        season4.setSeason_id(<span class="number">4</span>);</span><br><span class="line">        season4.setTitle(<span class="string">"少女终末旅行"</span>);</span><br><span class="line"> </span><br><span class="line">        seasons.add(season3);</span><br><span class="line">        seasons.add(season4);</span><br><span class="line"> </span><br><span class="line">        student.setSeasons(seasons);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> student;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ok，截止目前，我们的程序已经写好了，但是，tomcat是如何知道这个Servlet类所在的地方呢？因此我们还需要给这个项目加一个叫<code>web.xml</code>的配置文件，它的位置在：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-35.png?imageView2/0/w1000" alt="图35" title="图35"></p>
<p>需要注意的是，WEB-INF是没办法省略的，否则tomcat无法读取到这个配置文件，下面我们来看看这个文件里都放了什么东西吧：</p>
<figure class="highlight xml"><figcaption><span>代码块14</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span> <span class="comment">&lt;!--指定一个Servlet块，并且告诉tomcat该Servlet的路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>StudentInfoController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.bilibili.controller.StudentInfoController<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>StudentInfoController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/get/student/info<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> <span class="comment">&lt;!-- http的url映射--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个文件是用来告诉tomcat，我自定义的Servlet类都在哪里，好让tomcat访问调用到，而下面的映射就更有意思了，你的浏览器在输入一个url时，除了域名，就是path了对吧？而这个映射的意思是说，当你在浏览器里输入“<a href="http://www.xx.com/get/student/info”时，这个url传到tomcat，tomcat可以根据path映射关系，找到这个叫StudentInfoController的Servlet，而这个Servlet对应哪个实现类呢？当然就是你自定义的子类StudentInfoController啦">www.xx.com/get/student/info”时，这个url传到tomcat，tomcat可以根据path映射关系，找到这个叫StudentInfoController的Servlet，而这个Servlet对应哪个实现类呢？当然就是你自定义的子类StudentInfoController啦</a>~</p>
<p>至此，你的这个简单的，只提供输出Student对象的接口，就完成了，下面让我们点击下tomcat的运行按钮，就可以启动了，假设我们现在已经启动了，在你的浏览器，输入：127.0.0.1:8080/get/student/info试试吧，它的运行结果如下（我自己改了端口号8081，所以图里是8081 -_-||，其次，localhost = 127.0.0.1，它表示的是你本机的ip地址）：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-36.png?imageView2/0/w1000" alt="图36" title="图36"></p>
<p>你可以打开下浏览器的检查功能，可以具体看到HTTP协议头信息：</p>
<p><img src="http://myblog.sharemer.com/2020/03/27/20200327-1-37.png?imageView2/0/w1000" alt="图37" title="图37"></p>
<p>我们设置的<code>Content-Type</code>它生效了，它通过HTTP协议头来告诉浏览器：“我传给你的业务数据流是以json做的序列化，你也得用json序列化”。</p>
<p>你可能会好奇，这个过程中怎么没见main方法啊？因为这个过程中你的程序只是陪衬，真正运行的程序是包含了你的业务代码的tomcat，所以启动这个动作肯定是发生在了tomcat。</p>
<h4 id="3-3-4：结束语"><a href="#3-3-4：结束语" class="headerlink" title="3.3.4：结束语"></a>3.3.4：结束语</h4><p>你写的普通的业务代码终于可以堂堂正正的让浏览器通过HTTP请求访问到了！！现在知道什么是java web了吧？其实一开始大家分的很细，像什么JAVA SE、JAVA EE，JAVA EE就是java web，也叫java企业级开发，其实你不用计较这么多，java就是java，因为你借助一个web程序tomcat完成了你让别人通过HTTP请求来触发你的业务程序，所以你写的程序也被叫成了java web，仅此而已，你需要学会从更宏观的角度来看待这些细微的差别，而不是死抠一些专有名词。</p>
<p>最后还是要说一下，你没发现写一个上面的程序，很特么复杂吗？还得下载配置tomcat，还得配置你的IDEA，还得指定各类序列化方式等等，让它可以结合tomcat运转你的程序，事实上，很多事情复杂到一定程度，就一定会有工程师去搞个更方便的东西出来，这也是接下来要让你们接触到的一个东西：spring boot。</p>
<p>别害怕，spring boot并不是单独一门技术，它就是spring，spring的一切特性它都具备，但是它是spring的进化态，它里面包含了一个tomcat！spring boot写好的程序，就自动包含了上面一堆有关tomcat的配置，你再也不用担心tomcat的任何事情，写个main方法就好~</p>
</div><div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2020/04/02/LV5-6%EF%BC%9Ajava%E5%B9%B6%E5%8F%91%E5%8C%85-juc%E7%9A%84%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/" target="_blank">LV5-6：java并发包-juc的简单介绍</a><br></span><span>  2.<a class="is-size-6" href="/2020/04/02/LV5-5%EF%BC%9A%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6%EF%BC%9Ajoin%E3%80%81yield%E3%80%81sleep%E3%80%81interrupt/" target="_blank">LV5-5：线程调度：join、yield、sleep、interrupt</a><br></span><span>  3.<a class="is-size-6" href="/2020/04/01/LV5-4%EF%BC%9A%E7%BA%BF%E7%A8%8B%E9%80%9A%E4%BF%A1%EF%BC%9Await%E3%80%81notify%E3%80%81notifyall/" target="_blank">LV5-4：线程通信：wait、notify、notifyall</a><br></span><span>  4.<a class="is-size-6" href="/2020/04/01/LV5-3%EF%BC%9Ajava%E9%87%8C%E7%9A%84%E5%90%8C%E6%AD%A5%E9%94%81/" target="_blank">LV5-3：java里的同步锁</a><br></span><span>  5.<a class="is-size-6" href="/2020/04/01/LV5-2%EF%BC%9A%E5%B9%B6%E5%8F%91&amp;%E5%B9%B6%E8%A1%8C/" target="_blank">LV5-2：并发&amp;并行</a><br></span><span>  6.<a class="is-size-6" href="/2020/03/31/LV5-1%EF%BC%9A%E8%BF%9B%E7%A8%8B%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E7%BA%BF%E7%A8%8B%E5%8F%88%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/" target="_blank">LV5-1：进程是什么？线程又是什么？</a><br></span><span>  7.<a class="is-size-6" href="/2020/03/25/LV4-4%EF%BC%9A%E4%BD%8D%E5%9B%BE/" target="_blank">LV4-4：位图</a><br></span><span>  8.<a class="is-size-6" href="/2020/03/23/LV4-3%EF%BC%9Ajava%E9%87%8C%E7%9A%84Map/" target="_blank">LV4-3：java里的Map</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="http://myblog.sharemer.com/alipay_qrcode.png" alt="支付宝"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="http://myblog.sharemer.com/wx_qrcode.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/03/31/LV5-1%EF%BC%9A%E8%BF%9B%E7%A8%8B%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E7%BA%BF%E7%A8%8B%E5%8F%88%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">LV5-1：进程是什么？线程又是什么？</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/03/25/LV4-4%EF%BC%9A%E4%BD%8D%E5%9B%BE/"><span class="level-item">LV4-4：位图</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            id: '1f094c9429d8d5f94ea1ed0b1b74169c',
            repo: 'exceting.github.io',
            owner: 'exceting',
            clientID: '17297b562584b5cec3d7',
            clientSecret: '46c7652ed4f09fb1d847d15df81500a5a2ceeae8',
            admin: ["exceting"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget toc-scroll" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-一、网络发展史" href="#一、网络发展史"><span>一、网络发展史</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-1-1：局域网" href="#1-1：局域网"><span>1.1：局域网</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-1-1-1：以太网简介" href="#1-1-1：以太网简介"><span>1.1.1：以太网简介</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-1-2：数据传输" href="#1-1-2：数据传输"><span>1.1.2：数据传输</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-1-3：冲突域" href="#1-1-3：冲突域"><span>1.1.3：冲突域</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-1-4：利用交换机降低冲突域大小" href="#1-1-4：利用交换机降低冲突域大小"><span>1.1.4：利用交换机降低冲突域大小</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-1-5：路由" href="#1-1-5：路由"><span>1.1.5：路由</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-1-2：广域网-amp-高级协议" href="#1-2：广域网-amp-高级协议"><span>1.2：广域网&amp;amp;高级协议</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-1-2-1：广域网" href="#1-2-1：广域网"><span>1.2.1：广域网</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-2-2：UDP协议" href="#1-2-2：UDP协议"><span>1.2.2：UDP协议</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-2-3：TCP-IP协议" href="#1-2-3：TCP-IP协议"><span>1.2.3：TCP&amp;#x2F;IP协议</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-2-4：DNS服务" href="#1-2-4：DNS服务"><span>1.2.4：DNS服务</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-2-5：网络协议分层" href="#1-2-5：网络协议分层"><span>1.2.5：网络协议分层</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-1-3：万维网" href="#1-3：万维网"><span>1.3：万维网</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-1-3-1：万维网简介" href="#1-3-1：万维网简介"><span>1.3.1：万维网简介</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-3-2：超链接" href="#1-3-2：超链接"><span>1.3.2：超链接</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-3-3：定位一个超文本页面" href="#1-3-3：定位一个超文本页面"><span>1.3.3：定位一个超文本页面</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-3-4：HTML、HTTP协议" href="#1-3-4：HTML、HTTP协议"><span>1.3.4：HTML、HTTP协议</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-3-5：浏览器、web服务器的发展史" href="#1-3-5：浏览器、web服务器的发展史"><span>1.3.5：浏览器、web服务器的发展史</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-3-6：第一个爬虫程序-amp-第一个搜索引擎" href="#1-3-6：第一个爬虫程序-amp-第一个搜索引擎"><span>1.3.6：第一个爬虫程序&amp;amp;第一个搜索引擎</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-1-4：我自己的个人电脑联通网络后可以被别的电脑通过ip-port访问到吗？" href="#1-4：我自己的个人电脑联通网络后可以被别的电脑通过ip-port访问到吗？"><span>1.4：我自己的个人电脑联通网络后可以被别的电脑通过ip+port访问到吗？</span></a></li><li><a class="is-flex toc-item" id="toc-item-1-5：结束语" href="#1-5：结束语"><span>1.5：结束语</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-二、序列化" href="#二、序列化"><span>二、序列化</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-2-1：序列化是做什么的？" href="#2-1：序列化是做什么的？"><span>2.1：序列化是做什么的？</span></a></li><li><a class="is-flex toc-item" id="toc-item-2-2：JAVA是如何做序列化的？" href="#2-2：JAVA是如何做序列化的？"><span>2.2：JAVA是如何做序列化的？</span></a></li><li><a class="is-flex toc-item" id="toc-item-2-3：FastJson与json序列化" href="#2-3：FastJson与json序列化"><span>2.3：FastJson与json序列化</span></a></li></ul></li><li><a class="is-flex toc-item" id="toc-item-三、Tomcat" href="#三、Tomcat"><span>三、Tomcat</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-3-1：Tomcat简介" href="#3-1：Tomcat简介"><span>3.1：Tomcat简介</span></a></li><li><a class="is-flex toc-item" id="toc-item-3-2：Servlet" href="#3-2：Servlet"><span>3.2：Servlet</span></a></li><li><a class="is-flex toc-item" id="toc-item-3-3：基于Servlet实现一个业务接口" href="#3-3：基于Servlet实现一个业务接口"><span>3.3：基于Servlet实现一个业务接口</span></a><ul class="menu-list toc"><li><a class="is-flex toc-item" id="toc-item-3-3-1：下一个tomcat先" href="#3-3-1：下一个tomcat先"><span>3.3.1：下一个tomcat先</span></a></li><li><a class="is-flex toc-item" id="toc-item-3-3-2：添加依赖包" href="#3-3-2：添加依赖包"><span>3.3.2：添加依赖包</span></a></li><li><a class="is-flex toc-item" id="toc-item-3-3-3：编写业务代码" href="#3-3-3：编写业务代码"><span>3.3.3：编写业务代码</span></a></li><li><a class="is-flex toc-item" id="toc-item-3-3-4：结束语" href="#3-3-4：结束语"><span>3.3.4：结束语</span></a></li></ul></li></ul></li></ul></div></div><script type="text/javascript" async>
        $(document).ready(function () { //参考自 https://github.com/ppoffice/hexo-theme-icarus/pull/616/files
            var observerTopMargin;
            var scrollObserver;
            var headerElems = $(".headerlink");
            var activeTocItem;
        
            function initIntersectionObserver(docHeight) {
                observerTopMargin = docHeight;
                scrollObserver = new IntersectionObserver(scrollCallBack,
                    {
                        root: null,  // viewpoint
                        rootMargin: docHeight + "px 0px -80% 0px"  // cover top 30% of viewport to the top of document
                    })
            }
        
            function scrollCallBack(entries, observer) {
                if ($(window).scrollTop() > observerTopMargin * 0.7) { 
                    // User somehow scroll to 70% of observerTopMargin (which is inited as 200% document height)
                    // Observer top margin need to extend to cover all the space to the top of the document
                    initIntersectionObserver(observerTopMargin * 2)
                    observer.disconnect();
                    return;
                }
                let toActive;
                if (entries[0].intersectionRatio == 1) {  // enter viewed area
                    let entry = entries.reduce((u, v) => (u.target.toc_id > v.target.toc_id ? u : v));  // get the lowest item
                    toActive = $("#toc-item-" + $(entry.target).attr("href").substr(1));
                } else {
                    let entry = entries.reduce((u, v) => (u.target.toc_id < v.target.toc_id ? u : v));  // get the highest item
                    let idx = Math.max(entry.target.toc_id - 1, 0);
                    toActive = $("#toc-item-" + $(headerElems[idx]).attr("href").substr(1));
                }
                if (activeTocItem) activeTocItem.removeClass("is-current");
                activeTocItem = toActive
                activeTocItem.addClass("is-current");
            }
        
            initIntersectionObserver($(document).height() * 2);
            headerElems.each(function (index, obj) {
                obj.toc_id = index;
                scrollObserver.observe(obj);
            })
        });</script></div><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="http://myblog.sharemer.com/avatar_2.png" alt="S-Virus"></figure><p class="title is-size-4 is-block line-height-inherit">S-Virus</p><p class="is-size-6 is-block">随机和因果，命运与无常，兼而有之</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>上海</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">71</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">35</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">65</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/exceting" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/exceting"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="bilibili" href="https://www.bilibili.com"><i class="fas fa-tv"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:1807301715@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-08T01:38:00.000Z">2020-06-08</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/08/%E6%B5%8E%E6%BA%90%E6%B8%B8%E8%AE%B0/">济源游记-20200517</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/%E6%97%A5%E5%B8%B8/">日常</a> / <a class="link-muted" href="/categories/%E6%97%A5%E5%B8%B8/%E6%97%85%E8%A1%8C/">旅行</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-01T16:11:00.000Z">2020-06-02</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/02/%E8%AF%A6%E8%A7%A3JDBC%E7%9A%84Loadbalance%E6%A8%A1%E5%BC%8F/">详解JDBC的Loadbalance模式</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/DB/">DB</a> / <a class="link-muted" href="/categories/DB/MySQL/">MySQL</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-02T07:47:00.000Z">2020-04-02</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/02/LV5-6%EF%BC%9Ajava%E5%B9%B6%E5%8F%91%E5%8C%85-juc%E7%9A%84%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/">LV5-6：java并发包-juc的简单介绍</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/JAVA%E5%9F%BA%E7%A1%80/">JAVA基础</a> / <a class="link-muted" href="/categories/JAVA%E5%9F%BA%E7%A1%80/JAVA%E8%BF%9B%E5%8C%96%E8%AE%BA/">JAVA进化论</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-02T06:40:00.000Z">2020-04-02</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/02/LV5-5%EF%BC%9A%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6%EF%BC%9Ajoin%E3%80%81yield%E3%80%81sleep%E3%80%81interrupt/">LV5-5：线程调度：join、yield、sleep、interrupt</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/JAVA%E5%9F%BA%E7%A1%80/">JAVA基础</a> / <a class="link-muted" href="/categories/JAVA%E5%9F%BA%E7%A1%80/JAVA%E8%BF%9B%E5%8C%96%E8%AE%BA/">JAVA进化论</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-01T13:35:00.000Z">2020-04-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/01/LV5-4%EF%BC%9A%E7%BA%BF%E7%A8%8B%E9%80%9A%E4%BF%A1%EF%BC%9Await%E3%80%81notify%E3%80%81notifyall/">LV5-4：线程通信：wait、notify、notifyall</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/JAVA%E5%9F%BA%E7%A1%80/">JAVA基础</a> / <a class="link-muted" href="/categories/JAVA%E5%9F%BA%E7%A1%80/JAVA%E8%BF%9B%E5%8C%96%E8%AE%BA/">JAVA进化论</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/DB/"><span class="level-start"><span class="level-item">DB</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/DB/InfluxDB/"><span class="level-start"><span class="level-item">InfluxDB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DB/MySQL/"><span class="level-start"><span class="level-item">MySQL</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DB/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98/"><span class="level-start"><span class="level-item">分布式缓存</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/IDEA%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">IDEA插件开发</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/JAVA%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">JAVA基础</span></span><span class="level-end"><span class="level-item tag">30</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/JAVA%E5%9F%BA%E7%A1%80/JAVA%E8%BF%9B%E5%8C%96%E8%AE%BA/"><span class="level-start"><span class="level-item">JAVA进化论</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/JAVA%E5%9F%BA%E7%A1%80/JVM/"><span class="level-start"><span class="level-item">JVM</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="level-start"><span class="level-item">并发编程</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/JUC/"><span class="level-start"><span class="level-item">JUC</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">四月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><span class="tag">基础知识</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%99%E7%A8%8B/"><span class="tag">教程</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="tag">并发编程</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/"><span class="tag">网络编程</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NIO/"><span class="tag">NIO</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="tag">多线程</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ThreadLocal/"><span class="tag">ThreadLocal</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/juc/"><span class="tag">juc</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%A0%E5%8C%96%E6%8A%80%E6%9C%AF/"><span class="tag">池化技术</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BF%9E%E6%8E%A5%E6%B1%A0/"><span class="tag">连接池</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Druid/"><span class="tag">Druid</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JVM/"><span class="tag">JVM</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenTracing/"><span class="tag">OpenTracing</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aop/"><span class="tag">aop</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ioc/"><span class="tag">ioc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/map/"><span class="tag">map</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring/"><span class="tag">spring</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BD%8D%E5%9B%BE/"><span class="tag">位图</span><span class="tag is-grey-lightest">2</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=removeifFeedsId&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="removeifFeedsId" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="订阅"></div></div><p class="help">如果需要订阅，可以尝试留下你的邮箱</p></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="http://myblog.sharemer.com/logooo.png" alt="S-Virus" height="28"></a><p class="size-small"><span>&copy; 2020 S-Virus</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>,Modify by <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">removeif</a> <br><span>© 版权说明：[本博客所有文档均由博主创作，作为博主本人记录生活和学习之用，站内文档禁止转载，如有关于本站的疑问，请<a href="/message" target="_blank">留言</a>]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2018/12/29 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/exceting"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2755914162" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://yoursite.com',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back-to-top.js" defer></script><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.12/js/lightgallery-all.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><!--!--><!--!--><!--!--><script src="/js/toc.js" defer></script><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('17297b562584b5cec3d7','46c7652ed4f09fb1d847d15df81500a5a2ceeae8','exceting','exceting.github.io',false);})</script><link rel="stylesheet" href="/css/insight.css"><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="想要查找什么..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>(function (window) {
            var INSIGHT_CONFIG = {
                TRANSLATION: {
                    POSTS: '文章',
                    PAGES: '页面',
                    CATEGORIES: '分类',
                    TAGS: '标签',
                    UNTITLED: '(无标题)',
                },
                CONTENT_URL: '/content.json',
            };
            window.INSIGHT_CONFIG = INSIGHT_CONFIG;
        })(window);</script><script src="/js/insight.js" defer></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('17297b562584b5cec3d7','46c7652ed4f09fb1d847d15df81500a5a2ceeae8','exceting','exceting.github.io',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>